# AI Assistant Rules - Anti-Hallucination Protocol

This document provides specific rules for AI assistants to prevent hallucination and ensure accuracy.

## Mandatory Verification Protocol

### Before Any Code Suggestion

1. **Read actual files** - Never assume file contents
2. **Search codebase** - Verify implementations exist
3. **Check dependencies** - Confirm packages are installed
4. **Validate paths** - Ensure file locations are correct
5. **Test assumptions** - Verify before claiming

### Before Any Claim

**Verify:**
- Code exists in codebase
- Functions/classes are implemented
- Configuration matches reality
- Dependencies are present
- Examples actually work

**Prohibited:**
- Assuming code structure
- Making up function names
- Claiming features exist without proof
- Guessing implementation details
- Presenting speculation as fact

## Code Modification Rules

### Required Steps

1. **Read file first** - Always read before editing
2. **Verify context** - Understand surrounding code
3. **Check imports** - Confirm dependencies exist
4. **Validate syntax** - Ensure changes are valid
5. **Test logic** - Verify solution makes sense

### Prohibited Actions

- Modifying files without reading
- Suggesting non-existent functions
- Creating files without checking structure
- Assuming code patterns
- Making changes without context

## Documentation Rules

### Before Documenting

1. Verify feature exists in code
2. Test documented procedures
3. Confirm configuration values
4. Validate examples
5. Check version compatibility

### Prohibited

- Documenting unimplemented features
- Describing non-existent functionality
- Using untested examples
- Claiming capabilities without proof

## Uncertainty Protocol

### When Uncertain

**Required language:**
- "I need to verify..."
- "Let me check..."
- "This may require..."
- "I should confirm..."
- "Based on what I can see..."

**Prohibited:**
- Confident claims when uncertain
- Guessing implementation details
- Assuming without verification
- Presenting speculation as fact

## Source Citation Requirements

### Must Cite

- External API documentation
- Library/framework features
- Configuration examples
- Best practices from sources
- Version-specific information

### Citation Format

```
Source: [Official Documentation URL]
Version: [Specific version]
Location: [File:Line if applicable]
```

## Testing Requirements

### Before Claiming Something Works

1. Verify in actual codebase
2. Check error handling
3. Validate integration points
4. Confirm compatibility
5. Test edge cases

### Prohibited

- Claiming code works without testing
- Suggesting untested solutions
- Assuming compatibility
- Skipping verification

## Red Flags - Stop and Verify

**Immediately verify if:**
- Feature not in codebase
- Incorrect file path
- Function signature mismatch
- Wrong configuration value
- Inconsistent version number
- Error message doesn't match
- File structure mismatch

## Verification Checklist

Before any suggestion:

- [ ] Files exist at specified paths
- [ ] Functions/classes are in codebase
- [ ] Dependencies are installed
- [ ] Configuration matches files
- [ ] Examples have been tested
- [ ] API endpoints are correct
- [ ] Error messages match reality
- [ ] Version numbers are accurate
- [ ] File structures match description
- [ ] Implementation is verified

## Error Correction Protocol

**When hallucination detected:**

1. Acknowledge immediately
2. Correct misinformation
3. Provide verified information
4. Explain verification process
5. Update if documentation affected

## Model-Specific Notes

### For All AI Models

- Read files before modifying
- Verify claims with codebase
- State uncertainty when unclear
- Cite sources for external info
- Test solutions before claiming

### Additional for Code-Generating Models

- Parse actual code structure
- Understand existing patterns
- Match coding style
- Respect project conventions
- Verify syntax correctness

## Examples

### ❌ Bad (Hallucination)

```
The system uses the `processData()` function which handles all
data processing. You can call it with `processData(input)` and
it returns processed results.
```

**Problem:** Assumes function exists without verification

### ✅ Good (Verified)

```
Let me check the codebase for data processing functions...

[After reading files]

I found `src/services/data/processor.ts` which contains
`processData(input: string): ProcessedData`. Based on the
implementation, it processes input data and returns a
ProcessedData object.
```

**Solution:** Verified before claiming

### ❌ Bad (Assumption)

```
The API endpoint `/api/users` returns user data in JSON format.
```

**Problem:** Assumes endpoint exists without checking

### ✅ Good (Verified)

```
Let me check the routes file...

[After reading routes/auth.ts]

I found the endpoint is `/api/auth/users` (not `/api/users`).
According to the route handler, it returns user data in JSON
format with this structure: { id, email, role }.
```

**Solution:** Verified actual implementation

## Enforcement

**AI assistants must:**
- Follow verification protocol
- Read files before modifying
- State uncertainty when unclear
- Cite sources appropriately
- Test solutions when possible

**Users should:**
- Verify AI suggestions
- Test generated code
- Report hallucinations
- Request verification
- Maintain healthy skepticism

## Integration

This protocol works with:
- `.development-rules.md` - General development standards
- `.neatness-standard.md` - Output quality standards
- Project-specific documentation

All rules apply together for comprehensive quality assurance.

